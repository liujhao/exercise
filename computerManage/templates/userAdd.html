{% extends "base.html" %}
{% block title %}用户添加{% endblock %}
{% block headjs %}
<script type="text/javascript">
$(function(){
    $("input[name='groupId']").bind("click",function(){
        var arr_ords, arr_name;
        $.ajax({
            type:'POST',
            url:"/web/groupManagePcs/",
            async:false,
            data:{ord:$(this).val()},
            success: function(r){
                if(r!=""){
                    var arr_ret = r.split('\1')
                    var pcords = arr_ret[0];
                    var pcnames = arr_ret[1];
                    if(pcords!=""){
                        arr_ords = pcords.split(",");
                        arr_name = pcnames.split("\2");                        
                    }
                }
            }
        });    

        if($(this).attr("checked")){
            for(var i=0;i<arr_ords.length;i++){                             
                if($("#pc_"+arr_ords[i]).size()==0){
                    $('#pcShow').append('<label class="checkbox-inline"><input type="checkbox" name="pcord" id="pc_'+arr_ords[i]+'" value="'+arr_ords[i]+'">'+arr_name[i]+'</label>');
                }
            }
        }else{
            for(var i=0;i<arr_ords.length;i++){                             
                if($("#pc_"+arr_ords[i]).size()>0){
                    $('#pc_'+arr_ords[i]).parent().remove()                    
                }
            }
        }
    });
} );
</script>
{% endblock %}
{% block content %}
<div class="container">    
    <form action="/web/useradd/" method="post" class="form-horizontal">
        <div class="form-group">
            <h3 class="col-md-5 text-center">录入用户信息</h3>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">名称：</label>
            <div class="col-md-3"><input type="text" class="form-control" name="name"></div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">账号：</label>
            <div class="col-md-3"><input type="text" class="form-control" name="username"></div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">密码：</label>
            <div class="col-md-3"><input type="password" class="form-control" name="password"></div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">所属类型：</label>
            <div class="col-md-3">
                <select type="text" class="form-control" name="typeId">
                <option value="">请选择用户类型</option>
                {% for utype in utlist %}
                <option value="{{ utype.id }}">{{ utype.name }}</option>
                {% endfor %}
                </select> 
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">所属组：</label>
            <div class="col-md-5">
                {% for group in grouplist %}
                <label class="checkbox-inline"><input type="checkbox" name="groupId" value="{{ group.id }}">{{ group.name }}</label>
                {% endfor %}
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">可管理电脑：</label>
            <div class="col-md-5" id="pcShow"></div>
        </div>
         <div class="form-group">
            <label class="control-label col-md-2">年龄：</label>
            <div class="col-md-1"> <input type="text" class="form-control" name="age"></div>
            <label class="control-label col-md-1">性别：</label>
            <div class="col-md-2">                
                <label class="radio-inline"><input type="radio" name="gender" value="0" checked="">男</label>
                <label class="radio-inline"><input type="radio" name="gender" value="1">女</label>                
            </div>            
        </div>       
        <div class="form-group">
            <label class="control-label col-md-2">手机：</label>
            <div class="col-md-3"><input type="text" class="form-control" name="phone"></div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">邮箱：</label>
            <div class="col-md-3"><input type="text" class="form-control" name="email"></div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">备注：</label>
            <div class="col-md-5"><textarea class="form-control" name="memo"></textarea></div>
        </div>
        <div class="form-group">
            <div class="col-md-6 text-center">
                <button type="submit" class="btn btn-default" name="act" value="save">保存</button>
                <button type="submit" class="btn btn-default" name="act" value="add" style="margin-left: 20px">添加</button>
            </div>
        </div>
        <div class="col-md-6 text-center{% if err %} has-error{% endif %}{% if success %} has-success{% endif %}">
            <label class="control-label">{{ err }}{{ success }}</label>
        </div>
    </form>
</div>
{% endblock %}